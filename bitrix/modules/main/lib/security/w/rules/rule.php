<? namespace Bitrix\Main\Security\W\Rules;$GLOBALS['____2084930680']= array(base64_decode('aXNfc3RyaW5'.'n'),base64_decode(''.'c3R'.'ydG9sb3dlcg='.'='),base64_decode('aX'.'NfYXJy'.'YXk='),base64_decode('aXNfc3RyaW5'.'n'),base64_decode(''.'Z3p'.'kZWNvZGU='),base64_decode('YmFz'.'ZTY'.'0X2RlY2'.'9kZQ=='),base64_decode('dXJsZ'.'GV'.'j'.'b2Rl'),base64_decode('Y'.'X'.'J'.'yYXlfcmV'.'2Z'.'XJ'.'zZQ'.'=='),base64_decode('Z3'.'plbmNvZG'.'U='),base64_decode('Y'.'m'.'FzZT'.'Y0X2VuY29kZQ=='),base64_decode('dXJsZW5jb'.'2Rl'),base64_decode(''.'YmluMmhleA=='),base64_decode(''.'aX'.'NfYXJ'.'yYXk='),base64_decode('c3'.'RydG9sb3'.'dlcg=='),base64_decode('aXNfYXJ'.'yYX'.'k'.'='),base64_decode('am9pbg'.'=='),base64_decode('Z'.'m5tYX'.'R'.'jaA=='),base64_decode('c'.'mF3dXJs'.'Z'.'GV'.'jb2R'.'l'),base64_decode(''.'c3'.'Vic3R'.'y'),base64_decode('c3Vi'.'c3Ry'),base64_decode('c3'.'RyX'.'3'.'JlcGxhY2U='),base64_decode('cHJlZ'.'19xdW'.'90ZQ='.'='),base64_decode('cHJ'.'lZ1'.'9tYXRjaA=='));if(!function_exists(__NAMESPACE__.'\\___615430569')){function ___615430569($_652695515){static $_1052979640= false; if($_1052979640 == false) $_1052979640=array('Y'.'W'.'N0aW'.'9u','aW5'.'0'.'d'.'m'.'Fs','cG'.'F0aA==','Y29'.'u'.'dG'.'V4dA'.'==','a2V'.'5'.'cw==',''.'cHJvY2Vzcw==','ZW5jb2Rpbm'.'c=','cH'.'JlZ19yZXBsYWNl','cGF'.'0aA='.'=','Y29udGV4dA==','a'.'2'.'V5cw==','cHJv'.'Y2Vzcw==','ZW5jb2Rpb'.'mc'.'=','cG'.'F0d'.'GVyb'.'g'.'='.'=',''.'cHJlZ19tYXRja'.'A==','cG'.'F0aA==','Y2'.'9udGV4dA==','a2V5cw==',''.'c'.'HJ'.'vY2'.'Vzcw==','ZW5jb'.'2R'.'pbmc=','cGF'.'0dGVybg==','cG'.'9'.'zd'.'F9'.'hY3R'.'pb24'.'=','Y2h'.'lY2'.'tfY3Ny'.'Zg==','cGF0a'.'A==','Y29udGV4dA'.'='.'=','a2V'.'5cw==',''.'cHJvY2'.'Vz'.'cw==','ZW5jb2'.'Rpbmc=',''.'cG'.'F0dGV'.'ybg==','Y'.'W'.'N0aW9u','YWN'.'0'.'aW9u','Y'.'W'.'N0a'.'W9u',''.'Y'.'WN'.'0aW9u','YW'.'N0aW9u','YWN0aW9u','cG9z'.'d'.'F9hY3Rpb24=',''.'ZW5jb'.'2'.'R'.'p'.'bmc=',''.'ZW5jb'.'2R'.'pb'.'mc=',''.'ZW'.'5jb'.'2Rpbm'.'c=',''.'Z'.'W5jb2Rpb'.'m'.'c'.'=',''.'ZW'.'5j'.'b2Rpbmc=',''.'ZW5'.'jb2Rpb'.'mc=','Z3'.'o=','Y'.'mFzZTY0','dX'.'Js','aGV4','L'.'g==',''.'Lw==','aW5'.'kZ'.'Xg'.'ucG'.'h'.'w','L'.'2lu'.'ZGV'.'4LnBocA'.'='.'=','U0N'.'SSVBUX05BTUU=','L2luZGV'.'4L'.'nBocA==',''.'U'.'0N'.'SSVB'.'UX05'.'BTUU=','U0NSSVBUX'.'05BTU'.'U=','U0'.'NSSVBUX0'.'5BTUU=','f'.'g==','fl'.'4'.'=','fg==','XH4=','JH4=');return base64_decode($_1052979640[$_652695515]);}}; use Bitrix\Main\IO\Path; use Bitrix\Main\Web\Uri; use Bitrix\Main\Security\W\Rules\Results\ModifyResult; abstract class Rule{ protected $_1042413510; protected $_436988947; protected $_1622458221; protected $_574920738; protected $_47864463; public static function make(array $_414492232):?static{ $_414492232= static::prepareRuleParameters($_414492232); return match($_414492232[___615430569(0)]){ ___615430569(1) => new IntvalRule( $_414492232[___615430569(2)], $_414492232[___615430569(3)], $_414492232[___615430569(4)], $_414492232[___615430569(5)], $_414492232[___615430569(6)]), ___615430569(7) => new PregReplaceRule( $_414492232[___615430569(8)], $_414492232[___615430569(9)], $_414492232[___615430569(10)], $_414492232[___615430569(11)], $_414492232[___615430569(12)], $_414492232[___615430569(13)]), ___615430569(14) => new PregMatchRule( $_414492232[___615430569(15)], $_414492232[___615430569(16)], $_414492232[___615430569(17)], $_414492232[___615430569(18)], $_414492232[___615430569(19)], $_414492232[___615430569(20)], $_414492232[___615430569(21)]), ___615430569(22) => new CsrfRule( $_414492232[___615430569(23)], $_414492232[___615430569(24)], $_414492232[___615430569(25)], $_414492232[___615430569(26)], $_414492232[___615430569(27)], $_414492232[___615430569(28)],), default => null,};} protected static function prepareRuleParameters(array $_1899785613): array{ if($GLOBALS['____2084930680'][0]($_1899785613[___615430569(29)])){ $_1899785613[___615430569(30)]= $GLOBALS['____2084930680'][1]($_1899785613[___615430569(31)]);} elseif($GLOBALS['____2084930680'][2]($_1899785613[___615430569(32)])){ $_401405470= $_1899785613[___615430569(33)]; $_1899785613[___615430569(34)]= $_401405470[min(124,0,41.333333333333)]; $_1899785613[___615430569(35)]= $_401405470[round(0+0.25+0.25+0.25+0.25)];} $_1899785613[___615430569(36)]=!empty($_1899785613[___615430569(37)])? $_1899785613[___615430569(38)]:[]; if($GLOBALS['____2084930680'][3]($_1899785613[___615430569(39)])){ $_1899785613[___615430569(40)]=[$_1899785613[___615430569(41)]];} return $_1899785613;}  public function __construct($_1042413510, $_436988947, $_1622458221, $_574920738, $_47864463){ $this->_1042413510= $_1042413510; $this->_436988947= $this->castContext($_436988947); $this->_1622458221= $this->castKeys($_1622458221); $this->_574920738= $_574920738; $this->_47864463= $_47864463;} public function evaluateValue($_1014690332){ if(!empty($this->_47864463)){ foreach($this->_47864463 as $_1313744368){ $_1014690332= match($_1313744368){ 'gz' => $GLOBALS['____2084930680'][4]($_1014690332), 'base64' => $GLOBALS['____2084930680'][5]($_1014690332), 'url' => $GLOBALS['____2084930680'][6]($_1014690332), 'hex' => hex2bin($_1014690332)};}} $_416684853= $this->evaluate($_1014690332); if(!empty($this->_47864463) && $_416684853 instanceof ModifyResult){ $_1093216162= $_416684853->getCleanValue(); foreach($GLOBALS['____2084930680'][7]($this->_47864463) as $_1313744368){ $_1093216162= match($_1313744368){ ___615430569(42) => $GLOBALS['____2084930680'][8]($_1093216162), ___615430569(43) => $GLOBALS['____2084930680'][9]($_1093216162), ___615430569(44) => $GLOBALS['____2084930680'][10]($_1093216162), ___615430569(45) => $GLOBALS['____2084930680'][11]($_1093216162)};} $_416684853= new ModifyResult($_1093216162);} return $_416684853;} abstract public function evaluate($_1014690332); protected function castContext($_436988947){ if(!$GLOBALS['____2084930680'][12]($_436988947)){ $_436988947=[$_436988947];} foreach($_436988947 as $_974853579 => $_1222075660){ $_436988947[$_974853579]= $GLOBALS['____2084930680'][13]($_1222075660);} return $_436988947;} protected function castKeys($_1622458221){ if(!$GLOBALS['____2084930680'][14]($_1622458221)){ $_1622458221=[$_1622458221];} return $_1622458221;} public function matchKey(array $_149002702): bool{ $_149002702= $GLOBALS['____2084930680'][15](___615430569(46), $_149002702); foreach($this->_1622458221 as $_703987315){   if($GLOBALS['____2084930680'][16]($_703987315, $_149002702)){ return true;}} return false;}  public function matchPath($_159091753){ if($this->_1042413510 === '*'){ return true;}  $_2100957728= new Uri($_159091753); $_847726407= $_2100957728->getPath(); $_847726407= $GLOBALS['____2084930680'][17]($_847726407);      if(str_ends_with($_847726407, ___615430569(47))){ $_847726407 .= ___615430569(48);} $_847726407= Path::normalize($_847726407);  $_578779319[]= $_847726407; if(str_ends_with($_847726407, ___615430569(49))){ $_578779319[]= $GLOBALS['____2084930680'][18]($_847726407, min(172,0,57.333333333333),-round(0+1.8+1.8+1.8+1.8+1.8));} elseif(str_ends_with($_SERVER[___615430569(50)], ___615430569(51))){ $_578779319[]= $GLOBALS['____2084930680'][19]($_SERVER[___615430569(52)],(161*2-322),-round(0+4.5+4.5));} if($_847726407 !== $_SERVER[___615430569(53)]){ $_578779319[]= $_SERVER[___615430569(54)];}  if(str_starts_with($this->_1042413510, ___615430569(55))){ $_349916670= $this->_1042413510;} else{ $_349916670= ___615430569(56). $GLOBALS['____2084930680'][20](___615430569(57), ___615430569(58), $GLOBALS['____2084930680'][21]($this->_1042413510)). ___615430569(59);} foreach($_578779319 as $_1566857054){ if($this->_1042413510 === $_1566857054 || $GLOBALS['____2084930680'][22]($_349916670, $_1566857054)){ return true;}} return false;}  public function getPath(){ return $this->_1042413510;}  public function getContext(){ return $this->_436988947;}  public function getKeys(){ return $this->_1622458221;}  public function getProcess(){ return $this->_574920738;}}?>